# 速金盈系统 - 烟测指南

## 📋 测试环境

- **后端服务**: http://localhost:8080 ✅ (PID: 12000)
- **前端服务**: http://localhost:5173 ✅
- **数据库**: MySQL 5.7
- **行情源**: WebSocket (上海黄金交易所) wss://push143.jtd9999.vip/ws

---

## 🎯 烟测目标

验证系统核心功能是否正常运行：
1. ✅ 前后端服务启动
2. ⏳ 用户认证功能
3. ⏳ 实时行情显示
4. ⏳ 交易功能
5. ⏳ 资金管理
6. ⏳ 持仓管理

---

## 🧪 测试步骤

### 第一步：访问系统
1. 打开浏览器访问: http://localhost:5173
2. 应该看到登录页面

### 第二步：用户注册（可选）
如果没有测试账号，可以注册新用户：

1. 点击"立即注册"
2. 填写注册信息：
   - 用户名: test_user
   - 密码: 123456
   - 真实姓名: 测试用户
   - 手机号: 13800138000
   - 邀请码: (需要从销售获取)
3. 提交注册
4. **注意**: 需要等待客服审核

### 第三步：用户登录 ⭐
使用测试账号登录：

**客户账号**:
- 用户名: `customer`
- 密码: `123456`

**管理员账号**:
- 用户名: `admin`
- 密码: `123456`

**预期结果**:
- ✅ 登录成功，跳转到首页
- ✅ Token保存到localStorage
- ✅ 显示用户信息
- ✅ 底部导航栏显示

### 第四步：实时行情测试 ⭐⭐⭐
在首页查看实时行情：

**检查项**:
1. ✅ 价格数字正常显示
2. ✅ 价格每秒更新（WebSocket连接）
3. ✅ 涨跌颜色变化（红涨绿跌）
4. ✅ 涨跌幅显示
5. ✅ 连接状态提示

**如何验证WebSocket连接**:
1. 打开浏览器开发者工具 (F12)
2. 切换到 Network 标签
3. 过滤 WS (WebSocket)
4. 应该看到 `ws://localhost:8080/ws/quote` 连接
5. 状态应该是 101 Switching Protocols
6. 可以看到实时消息流

**故障排查**:
- 如果价格不更新，检查后端日志
- 查看是否有 "WebSocket行情代理已启动" 日志
- 确认上游行情源连接正常

### 第五步：交易功能测试 ⭐⭐
点击底部导航"交易"进入交易页面：

**买入测试**:
1. 选择"买入"标签
2. 点击"市价"按钮自动填充当前价格
3. 输入数量: 10 克
4. 查看总金额和定金计算是否正确
   - 总金额 = 价格 × 数量
   - 定金 = 总金额 × 10%
5. 点击"买入"按钮
6. 确认订单提交成功

**卖出测试**:
1. 选择"卖出"标签
2. 填写价格和数量
3. 点击"卖出"按钮
4. 确认订单提交成功

**预期结果**:
- ✅ 表单验证正常
- ✅ 价格计算准确
- ✅ 订单提交成功
- ✅ 跳转到订单详情
- ✅ Toast提示显示

### 第六步：持仓管理测试
点击"持仓"查看持仓列表：

**检查项**:
1. ✅ 持仓列表正常显示
2. ✅ 盈亏实时计算（根据当前价格）
3. ✅ 盈亏率显示
4. ✅ 颜色区分（盈利红色/亏损绿色）
5. ✅ 可以点击"卖出"平仓

**验证盈亏计算**:
- 盈亏 = (当前价 - 买入价) × 数量
- 盈亏率 = 盈亏 / (买入价 × 数量) × 100%

### 第七步：资金管理测试
点击"资金"查看资金页面：

**检查项**:
1. ✅ 总资产显示
2. ✅ 可用余额显示
3. ✅ 冻结资金显示
4. ✅ 充值功能正常
5. ✅ 提现功能正常
6. ✅ 资金流水记录

**充值测试**:
1. 点击"充值"按钮
2. 输入金额: 10000
3. 选择银行卡（需要先添加银行卡）
4. 提交申请
5. 等待管理员审核

**提现测试**:
1. 点击"提现"按钮
2. 输入金额（不超过可用余额）
3. 选择银行卡
4. 提交申请

### 第八步：个人中心测试
点击"我的"进入个人中心：

**检查项**:
1. ✅ 用户信息显示
2. ✅ 角色显示
3. ✅ 功能菜单显示
4. ✅ 修改密码功能
5. ✅ 退出登录功能

**修改密码测试**:
1. 点击"修改密码"
2. 输入旧密码: 123456
3. 输入新密码: 654321
4. 确认新密码: 654321
5. 提交修改
6. 退出登录
7. 使用新密码登录验证

### 第九步：管理功能测试（管理员）
使用管理员账号登录：

**用户审核**:
1. 进入"用户管理"
2. 查看待审核用户
3. 点击"通过"或"拒绝"
4. 验证状态更新

**充值审核**:
1. 进入"充值审核"
2. 查看待审核充值申请
3. 点击"通过"
4. 验证用户余额增加

**提现审核**:
1. 进入"提现审核"
2. 查看待审核提现申请
3. 点击"通过"
4. 验证用户余额减少

---

## 🔍 检查清单

### 前端检查
- [ ] 页面加载正常
- [ ] 路由跳转正常
- [ ] Token自动刷新
- [ ] WebSocket连接稳定
- [ ] 错误提示友好
- [ ] 加载状态显示
- [ ] 下拉刷新正常
- [ ] 无控制台错误

### 后端检查
- [ ] 服务启动成功
- [ ] 数据库连接正常
- [ ] WebSocket行情正常
- [ ] API响应正常
- [ ] JWT认证正常
- [ ] 权限控制正常
- [ ] 日志输出正常
- [ ] 无panic错误

### 数据检查
- [ ] 用户数据正确
- [ ] 订单数据正确
- [ ] 持仓数据正确
- [ ] 资金数据正确
- [ ] 流水记录正确

---

## 🐛 常见问题

### Q1: 前端页面空白
**解决方案**:
1. 打开浏览器控制台查看错误
2. 检查API地址配置是否正确
3. 确认后端服务是否启动

### Q2: WebSocket连接失败
**解决方案**:
1. 检查后端日志，确认行情代理启动
2. 查看浏览器Network标签WS连接状态
3. 确认上游行情源 wss://push143.jtd9999.vip/ws 可访问

### Q3: 登录后Token过期
**解决方案**:
1. 检查JWT配置是否正确
2. 确认系统时间同步
3. 查看Token有效期配置

### Q4: 价格不更新
**解决方案**:
1. 检查WebSocket连接状态
2. 查看后端日志行情数据
3. 确认前端Store正确订阅

### Q5: 订单提交失败
**解决方案**:
1. 检查余额是否充足
2. 查看后端日志错误信息
3. 确认价格和数量验证规则

---

## 📊 性能指标

### 响应时间
- 登录: < 500ms
- API请求: < 300ms
- 页面加载: < 1s
- WebSocket消息: < 100ms

### 并发能力
- 支持100+在线用户
- WebSocket稳定连接
- 数据库查询优化

---

## 📝 测试记录模板

```markdown
## 测试日期: 2025-11-18
## 测试人员: [姓名]

### 环境信息
- 浏览器: Chrome 120
- 操作系统: Windows 11
- 后端版本: v1.0
- 前端版本: v1.0

### 测试结果
| 功能模块 | 测试项 | 结果 | 问题描述 |
|---------|--------|------|---------|
| 用户认证 | 登录 | ✅ | 无 |
| 用户认证 | 注册 | ✅ | 无 |
| 实时行情 | WebSocket | ✅ | 无 |
| 实时行情 | 价格更新 | ✅ | 无 |
| 交易功能 | 买入下单 | ✅ | 无 |
| 交易功能 | 卖出下单 | ✅ | 无 |
| 持仓管理 | 列表显示 | ✅ | 无 |
| 持仓管理 | 盈亏计算 | ✅ | 无 |
| 资金管理 | 充值申请 | ✅ | 无 |
| 资金管理 | 提现申请 | ✅ | 无 |
| 个人中心 | 信息显示 | ✅ | 无 |
| 个人中心 | 修改密码 | ✅ | 无 |

### 发现的问题
1. [问题描述]
   - 严重程度: 高/中/低
   - 复现步骤: 
   - 预期结果:
   - 实际结果:

### 建议
1. [优化建议]
```

---

## 🚀 快速测试命令

### 启动服务
```bash
# 后端
cd backend
go run cmd/server/main.go

# 前端
cd frontend
npm run dev
```

### 停止服务
```bash
# Windows
taskkill /F /PID 12000  # 后端
Ctrl + C                # 前端
```

### 查看日志
```bash
# 后端日志
tail -f logs/app.log

# 前端控制台
F12 -> Console
```

---

## ✅ 测试通过标准

### 必须满足
1. ✅ 所有核心功能正常
2. ✅ 无阻塞性Bug
3. ✅ WebSocket连接稳定
4. ✅ 数据计算准确
5. ✅ 用户体验流畅

### 可接受
1. ⚠️ 非核心功能小问题
2. ⚠️ UI细节优化
3. ⚠️ 性能优化建议

### 不可接受
1. ❌ 核心功能失效
2. ❌ 数据错误
3. ❌ 安全漏洞
4. ❌ 系统崩溃

---

**测试完成后请填写测试报告并提交给项目负责人！**

**祝测试顺利！** 🎉
