# ğŸ”§ åç«¯æœåŠ¡é‡å¯å’Œæµ‹è¯•æŒ‡å—

## é—®é¢˜åˆ†æ

404é”™è¯¯è¡¨ç¤ºåç«¯è·¯ç”±æœªç”Ÿæ•ˆï¼Œæœ€å¯èƒ½çš„åŸå› æ˜¯ï¼š**åç«¯æœåŠ¡æœªé‡å¯**

---

## âœ… è§£å†³æ­¥éª¤

### æ­¥éª¤1: åœæ­¢ç°æœ‰çš„åç«¯æœåŠ¡

**æ–¹æ³•1**: åœ¨è¿è¡Œåç«¯çš„ç»ˆç«¯æŒ‰ `Ctrl + C`

**æ–¹æ³•2**: å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿è¡Œçš„ç»ˆç«¯ï¼Œåœ¨PowerShellä¸­æ‰§è¡Œï¼š
```powershell
# æŸ¥æ‰¾Goè¿›ç¨‹
Get-Process | Where-Object {$_.Name -like "*go*" -or $_.ProcessName -like "*main*"}

# æˆ–è€…æŸ¥æ‰¾å ç”¨8080ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8080

# ç»ˆæ­¢è¿›ç¨‹ï¼ˆæ›¿æ¢PIDä¸ºå®é™…çš„è¿›ç¨‹IDï¼‰
taskkill /F /PID <è¿›ç¨‹ID>
```

---

### æ­¥éª¤2: é‡æ–°å¯åŠ¨åç«¯æœåŠ¡

```powershell
cd e:\AI\SuxinZK\code\backend
go run cmd/main.go
```

**é¢„æœŸè¾“å‡º**:
```
Listening on :8080
WebSocketæœåŠ¡å¯åŠ¨æˆåŠŸ
```

---

### æ­¥éª¤3: éªŒè¯APIæ˜¯å¦å¯ç”¨

#### æ–¹æ³•1: ä½¿ç”¨PowerShellæµ‹è¯•

```powershell
# ç®€å•æµ‹è¯•ï¼ˆæ— éœ€Tokenï¼‰
curl.exe http://localhost:8080/api/v1/user/paypass -v

# åº”è¯¥è¿”å› 401ï¼ˆéœ€è¦è®¤è¯ï¼‰ï¼Œè€Œä¸æ˜¯ 404
```

#### æ–¹æ³•2: ä½¿ç”¨æµè§ˆå™¨

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. åœ¨å‰ç«¯ç‚¹å‡»"è®¾ç½®æ”¯ä»˜å¯†ç "
4. æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…ï¼š
   - **404**: åç«¯æœªé‡å¯æˆ–è·¯ç”±æœªæ³¨å†Œ
   - **401**: æ­£å¸¸ï¼ˆéœ€è¦JWTè®¤è¯ï¼‰
   - **400**: æ­£å¸¸ï¼ˆå‚æ•°é”™è¯¯ï¼‰

---

### æ­¥éª¤4: æ£€æŸ¥åç«¯æ—¥å¿—

é‡å¯åç«¯åï¼Œåœ¨æ§åˆ¶å°åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
[GIN-debug] POST   /api/v1/auth/register
[GIN-debug] POST   /api/v1/auth/login
[GIN-debug] POST   /api/v1/auth/refresh
[GIN-debug] POST   /api/v1/auth/logout
[GIN-debug] GET    /api/v1/user/profile
[GIN-debug] POST   /api/v1/user/paypass       â† åº”è¯¥çœ‹åˆ°è¿™è¡Œï¼
[GIN-debug] POST   /api/v1/user/paypass/set
[GIN-debug] POST   /api/v1/user/password
```

å¦‚æœæ²¡æœ‰çœ‹åˆ° `/api/v1/user/paypass`ï¼Œè¯´æ˜ä»£ç æœªæ­£ç¡®ä¿å­˜æˆ–ç¼–è¯‘é”™è¯¯ã€‚

---

## ğŸ§ª å®Œæ•´æµ‹è¯•æµç¨‹

### 1. ç¡®è®¤åç«¯å·²å¯åŠ¨

```powershell
# æµ‹è¯•å¥åº·æ£€æŸ¥ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
curl.exe http://localhost:8080/health

# æˆ–æµ‹è¯•ç™»å½•æ¥å£
curl.exe http://localhost:8080/api/v1/auth/login -v
```

### 2. å‰ç«¯ç™»å½•è·å–Token

1. è®¿é—® http://localhost:5173/login
2. ç™»å½•ç³»ç»Ÿ
3. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ Application â†’ Local Storage
4. æ‰¾åˆ° `token` çš„å€¼

### 3. ä½¿ç”¨Tokenæµ‹è¯•API

```powershell
# PowerShellæµ‹è¯•
$token = "YOUR_JWT_TOKEN_HERE"

# æµ‹è¯•è®¾ç½®æ”¯ä»˜å¯†ç 
$headers = @{
    "Content-Type" = "application/json"
    "Authorization" = "Bearer $token"
}

$body = @{
    new_pay_password = "123456"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8080/api/v1/user/paypass" `
    -Method Post `
    -Headers $headers `
    -Body $body
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: ä»ç„¶æ˜¯404

**å¯èƒ½åŸå› **:
- åç«¯æœªé‡å¯
- ç¼–è¯‘é”™è¯¯ï¼ˆæ£€æŸ¥ç»ˆç«¯è¾“å‡ºï¼‰
- ç«¯å£å ç”¨ï¼ˆæ¢ä¸ªç«¯å£ï¼‰

**è§£å†³**:
```powershell
# å®Œå…¨æ¸…ç†å¹¶é‡å¯
cd backend
go clean
go mod tidy
go run cmd/main.go
```

---

### é—®é¢˜2: ç¼–è¯‘é”™è¯¯

**æ£€æŸ¥import**:
```go
import (
    "suxin/internal/pkg/security"  // ç¡®ä¿è¿™ä¸ªå¯¼å…¥å­˜åœ¨
)
```

**æ£€æŸ¥å‡½æ•°**:
```go
validatePayPass()  // ç¡®ä¿è¿™ä¸ªå‡½æ•°å­˜åœ¨
security.HashPassword()  // ç¡®ä¿è¿™ä¸ªå‡½æ•°å­˜åœ¨
security.CheckPassword()  // ç¡®ä¿è¿™ä¸ªå‡½æ•°å­˜åœ¨
```

---

### é—®é¢˜3: 401é”™è¯¯

**è¿™æ˜¯æ­£å¸¸çš„ï¼** 401è¡¨ç¤ºè·¯ç”±å­˜åœ¨ä½†éœ€è¦è®¤è¯ã€‚

åœ¨å‰ç«¯ï¼š
1. ç¡®ä¿å·²ç™»å½•
2. Tokenå­˜å‚¨åœ¨localStorage
3. requestæ‹¦æˆªå™¨è‡ªåŠ¨æ·»åŠ Token

---

## ğŸ“‹ å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] åç«¯ä»£ç å·²ä¿å­˜ï¼ˆCtrl+Sï¼‰
- [ ] åç«¯æœåŠ¡å·²åœæ­¢
- [ ] åç«¯æœåŠ¡å·²é‡æ–°å¯åŠ¨
- [ ] æ§åˆ¶å°æ˜¾ç¤ºè·¯ç”±æ³¨å†Œä¿¡æ¯
- [ ] æ²¡æœ‰ç¼–è¯‘é”™è¯¯
- [ ] ç«¯å£8080æœªè¢«å ç”¨
- [ ] å‰ç«¯å·²åˆ·æ–°ï¼ˆCtrl+Shift+Rï¼‰
- [ ] ç”¨æˆ·å·²ç™»å½•
- [ ] Tokenæœ‰æ•ˆ

---

## ğŸ¯ é¢„æœŸç»“æœ

**æˆåŠŸçš„æµç¨‹**:
1. âœ… åç«¯å¯åŠ¨ï¼Œæ˜¾ç¤ºè·¯ç”±æ³¨å†Œ
2. âœ… å‰ç«¯è®¿é—® http://localhost:5173/mine
3. âœ… ç‚¹å‡»"è®¾ç½®æ”¯ä»˜å¯†ç "
4. âœ… è¾“å…¥6ä½æ•°å­—
5. âœ… æ˜¾ç¤º"æ”¯ä»˜å¯†ç è®¾ç½®æˆåŠŸ"
6. âœ… çŠ¶æ€å˜ä¸º"å·²è®¾ç½®"

---

## ğŸ’¡ ä¸´æ—¶æµ‹è¯•æ–¹æ¡ˆ

å¦‚æœåç«¯ä¸€ç›´æœ‰é—®é¢˜ï¼Œå¯ä»¥ä¸´æ—¶ä½¿ç”¨æ—§æ¥å£æµ‹è¯•ï¼š

**åç«¯å·²æœ‰çš„æ—§æ¥å£**: `POST /api/v1/user/paypass/set`

**ä¸´æ—¶ä¿®æ”¹å‰ç«¯APIé…ç½®**:
```javascript
// frontend/src/config/api.js
PAYPASS: '/api/v1/user/paypass/set',  // ä¸´æ—¶ä½¿ç”¨æ—§æ¥å£
```

**å¯¹åº”çš„åç«¯ä»£ç **ï¼ˆå·²å­˜åœ¨ï¼‰:
```go
pg.POST("/paypass/set", func(c *gin.Context) {
    // ...
})
```

ä½†è¿™ä¸ªæ—§æ¥å£ä¸æ”¯æŒä¿®æ”¹å¯†ç ï¼Œåªèƒ½é¦–æ¬¡è®¾ç½®ã€‚

---

## âœ… æœ€ç»ˆç¡®è®¤

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç¡®è®¤APIå¯ç”¨ï¼š

```powershell
# ä¸éœ€è¦Tokençš„æµ‹è¯•ï¼ˆä¼šè¿”å›401ï¼Œä½†è¯æ˜è·¯ç”±å­˜åœ¨ï¼‰
curl.exe -X POST http://localhost:8080/api/v1/user/paypass `
    -H "Content-Type: application/json" `
    -d '{\"new_pay_password\":\"123456\"}' `
    -v

# å¦‚æœè¿”å› 401: {"error":"æœªæˆæƒ"} - è·¯ç”±å­˜åœ¨ âœ…
# å¦‚æœè¿”å› 404 - è·¯ç”±ä¸å­˜åœ¨ï¼Œéœ€è¦é‡å¯åç«¯ âŒ
```

---

**è¯·æŒ‰ç…§æ­¥éª¤æ“ä½œï¼Œé‡å¯åç«¯æœåŠ¡åå†æµ‹è¯•ï¼**
